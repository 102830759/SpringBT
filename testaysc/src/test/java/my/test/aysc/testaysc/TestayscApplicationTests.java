package my.test.aysc.testaysc;

import my.test.aysc.testaysc.config.ContextUtil;
import my.test.aysc.testaysc.task.AsyncTaskService;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.core.task.TaskRejectedException;
import org.springframework.test.context.junit4.SpringRunner;

import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.Future;

@RunWith(SpringRunner.class)
@SpringBootTest
public class TestayscApplicationTests {

    @Test
    public void contextLoads() throws InterruptedException, ExecutionException {
        AsyncTaskService asyncTaskService = ContextUtil.getBean(AsyncTaskService.class);

        List<Future<String>> lstFuture = new ArrayList<Future<String>>();// 存放所有的线程，用于获取结果
        String[] urls = new String[]{

                "http://china.alibaba.com"
                , "http://www.baidu.com"
                , "http://www.hc360.com"
                , "http://www.palmbiz.net"
                , "http://www.cbsources.com"
                , "http://www.wdexporters.com"
                , "http://www.northbusiness.net"
                , "http://www.ibrandwatch.com"
                , "http://www.exportersarea.com"
                , "http://www.worldpcnet.com"
                , "http://www.instrtrade.com"
                , "http://www.instrbiz.com"
                , "http://www.europetradearea.com"
                , "http://www.worldchembiz.com"
                , "http://www.medicinetrade.net"
                , "http://www.wdimporters.com"
                , "http://www.healthbiz.cn"
                , "http://www.clothingtrade.net"
                , "http://www.tradeusd.com"
                , "http://www.clothtrade.net"
                , "http://www.ileather.net"
                , "http://www.worldpacktrade.com"
                , "http://www.worldplasticbiz.com"
                , "http://www.coatingtrade.com"
                , "http://www.tradewebsites.net"
                , "http://www.coatingbiz.cn"
                , "http://www.lockbiz.cn"
                , "http://www.pumpvalvebiz.com"
                , "http://www.7traders.com"
                , "http://www.eurotradeport.com"
                , "http://www.worldautotrade.net"
                , "http://www.electricworld.net"
                , "http://www.electricbiz.cn"
                , "http://www.seepuu.com"
                , "http://www.farmingbiz.net"
                , "http://www.silkproduct.net"
                , "http://www.meattrade.net"
                , "http://www.worldmilk.net"
                , "http://www.batterytrade.com.cn"
                , "http://www.drinktrade.com"
                , "http://www.ucbl.com.cn"
                , "http://www.hcinfo.com.cn"
                , "http://www.3ctrade.com"
                , "http://big5.busytrade.com"
                , "http://www.hbeb.com"
                , "http://www.westb2b.com"
                , "http://www.enetbase.com"
                , "http://www.hxsw.com"
                , "http://www.chinachamber.com.cn"
                , "http://oneone.com.cn"
                , "http://www.diyi.biz/"
                , "http://www.ub.net.cn"
                , "http://www.usimporters.us/"
                , "http://www.8848.com.cn"
                , "http://www.cfull.com"
                , "http://www.chinaccm.com"
                , "http://www.cbde.net"
                , "http://www.chinagq.com"
                , "http://www.materialbiz.com"
                , "http://china.coatingbiz.cn"
                , "http://www.tradecab.com"
                , "http//www.goodsbridge.com"
                , "http://www.maxpolo.com.cn"
                , "http://tradeonline.gxchina.com"
                , "http://china.zhuboo.com"
                , "http://china.lightingtrade.net"
                , "http://china.semitrade.cn"
                , "http://china.jxtrade.net"
                , "http://china.machinebiz.com.cn"
                , "http://china.imachinetrade.com"
                , "http://china.worldmetaltrade.com"
                , "http://china.worldsteeltrade.com"
                , "http://china.ibrandwatch.com"
                , "http://china.worldpcnet.com"
                , "http://china.instrtrade.com"
                , "http://china.instrbiz.com"
                , "http://china.worldchembiz.com"
                , "http://china.medicinetrade.net"
                , "http://china.healthbiz.cn"
                , "http://china.clothingtrade.net"
                , "http://china.clothtrade.net"
                , "http://china.ileather.net"
                , "http://china.worldpacktrade.com"
                , "http://china.worldplasticbiz.com"
                , "http://china.coatingtrade.com"
                , "http://www.imachinetrade.com"
                , "http://www.worldmetaltrade.com"
                , "http://www.worldsteeltrade.com"
                , "http://china.electricworld.net"
                , "http://china.electricbiz.cn"
                , "http://china.materialbiz.com"
                , "http://china.ifoodtrade.com"
                , "http://china.itoytrade.com"
                , "http://china.sporterbiz.com"
                , "http://china.bghy.net"
                , "http://china.ihousetrade.net"
                , "http://china.ihousetrade.cn"
                , "http://china.ihomea.com"
                , "http://china.ihomea.cn"
                , "http://china.minetrade.net"
                , "http://china.globalmine.net"
                , "http://china.ienergytrade.com"
                , "http://china.oiltime.net"
                , "http://china.oiltime.cn"
                , "http://china.topenv.com"
                , "http://china.goodenv.net"
                , "http://china.worldpaperbiz.com"
                , "http://china.icommunicate.cn"
                , "http://china.ibrandworld.com"
                , "http://china.gardenbiz.cn"
                , "http://china.worldgardenbiz.com"
                , "http://china.hotcosmetic.net"
                , "http://china.topcosmetic.cn"
                , "http//china.iwinebiz.com"
                , "http://www.66199.com"
                , "http://www.cm001.com.cn"
                , "http://www.cm001.com.cn"
                , "http://www.cm001.com.cn"
                , "http://www.cm001.com.cn"
                , "http://www.richful-hk.com"
                , "http://www.86ec.com"
                , "http://www.wecn.com"
                , "http://www.boyiheng.com.cn"
                , "http://cn.tpage.com"
                , "http://china.sw365.com"
                , "http://www.alsk.net"
                , "http://www.21cei.com"
                , "http://www.worldgardenbiz.com"
                , "http://www.hotcosmetic.net"
                , "http://www.topcosmetic.cn"
                , "http://www.iwinebiz.com"
                , "http://www.iwinebiz.cn"
                , "http://www.teahill.net"
                , "http://www.teahill.com.cn"
                , "http://www.goodtobacco.net"
                , "http://www.digesttrade.com"
                , "http://www.luxurybiz.net"
                , "http://www.luxurybiz.cn"
                , "http://www.safety-first.cn"
                , "http://www.tvmediabiz.com"
                , "http://china.lockbiz.cn"
                , "http://china.pumpvalvebiz.com"
                , "http://china.worldautotrade.net"
                , "http://www.fj8848.com"
                , "http://www.7151.com.cn"
                , "http://shop.sunbu.com"
                , "http://www.163sm.net"
                , "http://www.cnban.com"
                , "http://china.iwinebiz.cn"
                , "http://china.teahill.net"
                , "http://china.teahill.com.cn"
                , "http://china.goodtobacco.net"
                , "http://china.digesttrade.com"
                , "http://china.luxurybiz.net"
                , "http://china.luxurybiz.cn"
                , "http://china.safety-first.cn"
                , "http://china.tvmediabiz.com"
                , "http://china.hailukong56.com"
                , "http://china.cmyyjcc.com"
                , "http://china.glasstrade.com.cn"
                , "http://china.biobiz.net"
                , "http://china.cleaningtrade.net"
                , "http://china.istoneage.net"
                , "http://china.seepuu.com"
                , "http://china.farmingbiz.net"
                , "http://china.silkproduct.net"
                , "http://china.meattrade.net"
                , "http://china.worldmilk.net"
                , "http://china.batterytrade.com.cn"
                , "http://china.drinktrade.com"
                , "http://www.zhuboo.com"
                , "http://www.lightingtrade.net"
                , "http://www.semitrade.cn"
                , "http://www.jxtrade.net"
                , "http://www.machinebiz.com.cn"
                , "http://www.ifoodtrade.com"
                , "http://www.itoytrade.com"
                , "http://www.sporterbiz.com"
                , "http://www.bghy.net"
                , "http://www.ihousetrade.net"
                , "http://www.ihousetrade.cn"
                , "http://www.ihomea.com"
                , "http://www.ihomea.cn"
                , "http://www.minetrade.net"
                , "http://www.globalmine.net"
                , "http://www.ienergytrade.com"
                , "http://www.oiltime.net"
                , "http://www.oiltime.cn"
                , "http://www.topenv.com"
                , "http://www.goodenv.net"
                , "http://www.worldpaperbiz.com"
                , "http://www.icommunicate.cn"
                , "http://www.ibrandworld.com"
                , "http://www.gardenbiz.cn"
                , "http://www.chinapt.com"
                , "http://www.xx-info.com"
                , "http://china.busytrade.com"
                , "http://www.todaynet.com.cn"
                , "http://www.suminfo.com"
                , "http://www.hailukong56.com"
                , "http://www.cmyyjcc.com"
                , "http://www.glasstrade.com.cn"
                , "http://www.biobiz.net"
                , "http://www.cleaningtrade.net"
                , "http://www.istoneage.net"
                , "http://www.cnebiz.net"
                , "http://www.wtochina.com"
                , "http://www.ce.net.cn"
                , "http://www.chesp.com"
                , "http://www.ceu.com.cn"
                , "http://www.cnsme.com"
                , "http://www.investguide.com.cn"
                , "http://www.china-pi.com"
                , "http://www.chinamarket.com.cn"
                , "http://www.tsseb.com"
                , "http://www.tipschina.gov.cn"
                , "http://www.cneb.net "

                , "http://www.snowyday.cn"
                , "http://www.kenwanmei.com"
                , "http://china.alibaba.com"
                , "http://www.hc360.com"
                , "http//www.tradeprince.com"
                , "http://www.palmbiz.net"
                , "http://www.cbsources.com"
                , "http://www.wdexporters.com"
                , "http://www.8xy.com"
                , "http://www.northbusiness.net"
                , "http://www.china118.com"
                , "http://www.ibrandwatch.com"
                , "http://www.exportersarea.com"
                , "http://www.worldpcnet.com"
                , "http://www.instrtrade.com"
                , "http://www.instrbiz.com"
                , "http://www.europetradearea.com"
                , "http://www.worldchembiz.com"
                , "http://www.medicinetrade.net"
                , "http://www.wdimporters.com"
                , "http://www.healthbiz.cn"
                , "http://www.clothingtrade.net"
                , "http//www.tradeusd.com"
                , "http://www.clothtrade.net"
                , "http://www.ileather.net"
                , "http://www.worldpacktrade.com"
                , "http://www.worldplasticbiz.com"
                , "http://www.coatingtrade.com"
                , "http//www.tradewebsites.net"
                , "http://www.coatingbiz.cn"
                , "http//www.lockbiz.cn"
                , "http://www.pumpvalvebiz.com"
                , "http://www.7traders.com"
                , "http://www.eurotradeport.com"
                , "http://www.worldautotrade.net"
                , "http://www.electricworld.net"
                , "http://www.electricbiz.cn"
                , "http://www.seepuu.com"
                , "http://www.farmingbiz.net"
                , "http://www.silkproduct.net"
                , "http://www.meattrade.net"
                , "http://www.worldmilk.net"
                , "http://www.batterytrade.com.cn"
                , "http://www.drinktrade.com"
                , "http://www.watchtrade.com.cn"
                , "http://china.watchtrade.com.cn"
                , "http://www.jewellerytrade.net"
                , "http://china.jewellerytrade.net"
                , "http://www.cj888.com"
                , "http://www.importersarea.com"
                , "http://www.focusnet.com.cn"
                , "http://coldfusion.chineseuser.com"
                , "http://dg.chinacommercer.com"
                , "http://www.maoyi.com"
                , "http://www.ucbl.com.cn"
                , "http://www.hcinfo.com.cn"
                , "http://www.3ctrade.com"
                , "http://big5.busytrade.com"
                , "http://www.hbeb.com"
                , "http://www.westb2b.com"
                , "http://www.enetbase.com"
                , "http://www.hxsw.com"
                , "http://www.chinachamber.com.cn"
                , "http://oneone.com.cn"
                , "http://www.diyi.biz/"
                , "http://www.ub.net.cn"
                , "http://www.usimporters.us/"
                , "http://www.8848.com.cn"
                , "http://www.cfull.com"
                , "http://www.chinaccm.com"
                , "http://www.cbde.net"
                , "http://www.chinagq.com"
                , "http://www.materialbiz.com"
                , "http://china.coatingbiz.cn"
                , "http://www.goodsbridge.com"
                , "http://www.maxpolo.com.cn"
                , "http://tradeonline.gxchina.com"
                , "http://china.zhuboo.com"
                , "http://china.lightingtrade.net"
                , "http://china.semitrade.cn"
                , "http://china.jxtrade.net"
                , "http://china.machinebiz.com.cn"
                , "http://china.imachinetrade.com"
                , "http://china.worldmetaltrade.com"
                , "http://china.worldsteeltrade.com"
                , "http://china.ibrandwatch.com"
                , "http://china.worldpcnet.com"
                , "http://china.instrtrade.com"
                , "http://china.instrbiz.com"
                , "http://china.worldchembiz.com"
                , "http://china.medicinetrade.net"
                , "http://china.healthbiz.cn"
                , "http://china.clothingtrade.net"
                , "http://china.clothtrade.net"
                , "http://china.ileather.net"
                , "http://china.worldpacktrade.com"
                , "http://china.worldplasticbiz.com"
                , "http://china.coatingtrade.com"
                , "http://www.imachinetrade.com"
                , "http://www.worldmetaltrade.com"
                , "http://www.worldsteeltrade.com"
                , "http://china.electricworld.net"
                , "http://china.electricbiz.cn"
                , "http://china.materialbiz.com"
                , "http://china.ifoodtrade.com"
                , "http://china.itoytrade.com"
                , "http://china.sporterbiz.com"
                , "http://china.bghy.net"
                , "http://china.ihousetrade.net"
                , "http://china.ihousetrade.cn"
                , "http://china.ihomea.com"
                , "http://china.ihomea.cn"
                , "http://china.minetrade.net"
                , "http://china.globalmine.net"
                , "http://china.ienergytrade.com"
                , "http://china.oiltime.net"
                , "http://china.oiltime.cn"
                , "http://china.topenv.com"
                , "http://china.goodenv.net"
                , "http://china.worldpaperbiz.com"
                , "http://china.icommunicate.cn"
                , "http://china.ibrandworld.com"
                , "http://china.gardenbiz.cn"
                , "http://china.worldgardenbiz.com"
                , "http://china.hotcosmetic.net"
                , "http://china.topcosmetic.cn"
                , "http://china.iwinebiz.com"
                , "http://www.66199.com"
                , "http://www.cm001.com.cn"
                , "http://www.richful-hk.com"
                , "http://www.86ec.com"
                , "http://www.wecn.com"
                , "http://www.boyiheng.com.cn"
                , "http://cn.tpage.com"
                , "http://china.sw365.com"
                , "http://www.alsk.net"
                , "http://www.21cei.com"
                , "http://www.worldgardenbiz.com"
                , "http://www.hotcosmetic.net"
                , "http://www.topcosmetic.cn"
                , "http://www.iwinebiz.com"
                , "http://www.iwinebiz.cn"
                , "http://www.teahill.net"
                , "http://www.teahill.com.cn"
                , "http://www.goodtobacco.net"
                , "http://www.digesttrade.com"
                , "http://www.luxurybiz.net"
                , "http://www.luxurybiz.cn"
                , "http://www.safety-first.cn"
                , "http://www.tvmediabiz.com"
                , "http://china.lockbiz.cn"
                , "http://china.pumpvalvebiz.com"
                , "http://china.worldautotrade.net"
                , "http://www.fj8848.com"
                , "http://www.7151.com.cn"
                , "http://shop.sunbu.com"
                , "http://www.163sm.net"
                , "http://www.cnban.com"
                , "http://china.iwinebiz.cn"
                , "http://china.teahill.net"
                , "http://china.teahill.com.cn"
                , "http://china.goodtobacco.net"
                , "http://china.digesttrade.com"
                , "http://china.luxurybiz.net"
                , "http://china.luxurybiz.cn"
                , "http://china.safety-first.cn"
                , "http://china.tvmediabiz.com"
                , "http://china.hailukong56.com"
                , "http://china.cmyyjcc.com"
                , "http://china.glasstrade.com.cn"
                , "http://china.biobiz.net"
                , "http://china.cleaningtrade.net"
                , "http://china.istoneage.net"
                , "http://china.seepuu.com"
                , "http://china.farmingbiz.net"
                , "http://china.silkproduct.net"
                , "http://china.meattrade.net"
                , "http://china.worldmilk.net"
                , "http://china.batterytrade.com.cn"
                , "http://china.drinktrade.com"
                , "http://www.zhuboo.com"
                , "http://www.lightingtrade.net"
                , "http://www.semitrade.cn"
                , "http://www.jxtrade.net"
                , "http://www.machinebiz.com.cn"
                , "http://www.ifoodtrade.com"
                , "http://www.itoytrade.com"
                , "http://www.sporterbiz.com"
                , "http://www.bghy.net"
                , "http://www.ihousetrade.net"
                , "http://www.ihousetrade.cn"
                , "http://www.ihomea.com"
                , "http:www.ihomea.cn"
                , "http://www.minetrade.net"
                , "http:www.globalmine.net"
                , "http://www.ienergytrade.com"
                , "http://www.oiltime.net"
                , "http://www.oiltime.cn"
                , "http://www.topenv.com"
                , "http://www.goodenv.net"
                , "http://www.worldpaperbiz.com"
                , "http://www.icommunicate.cn"
                , "http://www.ibrandworld.com"
                , "http://www.gardenbiz.cn"
                , "http://www.chinapt.com"
                , "http://www.xx-info.com"
                , "http://china.busytrade.com"
                , "http:www.todaynet.com.cn"
                , "http:www.suminfo.com"
                , "http://www.hailukong56.com"
                , "http://www.cmyyjcc.com"
                , "http://www.glasstrade.com.cn"
                , "http://www.biobiz.net"
                , "http://www.cleaningtrade.net"
                , "http://www.istoneage.net"
                , "http://www.cnebiz.net"
                , "http://www.wtochina.com"
                , "http://www.ce.net.cn"
                , "http://www.chesp.com"
                , "http://www.ceu.com.cn"
                , "http://www.cnsme.com"
                , "http://www.investguide.com.cn"
                , "http://www.china-pi.com"
                , "http://www.chinamarket.com.cn"
                , "http://www.tsseb.com"
                , "http://www.tipschina.gov.cn"
                , "http://www.cneb.net"
        };
        // 根据任务的长度创建适当的线程任务
        for (int i = 0; i <= urls.length; i++) {
            while (true) {
                try {
                    // 线程池超过最大线程数时，会抛出TaskRejectedException，则等待1s，直到不抛出异常为止
                    asyncTaskService.asyncInvokeReturnFuture(urls[i]);
//                    lstFuture.add(future);

                    break;
                } catch (TaskRejectedException e) {
                    System.out.println("线程池满，等待0.5S。");
                    Thread.sleep(500);
                }
            }
        }

        // 获取值。get是阻塞式，等待当前线程完成才返回值
//        for (int i = 0; i < lstFuture.size(); i++) {
//            try {
//                System.out.println(lstFuture.get(i).get());
//            } catch (Exception e) {
//                System.out.println("任务：" + i + "执行失败！！！");
//            }
//
//        }

    }
}
